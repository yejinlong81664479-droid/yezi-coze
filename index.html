<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ±‚èŒå¯¼å¸ˆ - AIé¢è¯•åŠ©æ‰‹å¹³å°</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-color: #F8FAFC;
      color: #1E293B;
      height: 100vh;
      overflow: hidden;
    }

    .app-container {
      display: flex;
      height: 100vh;
    }

    /* å·¦ä¾§å¯¼èˆªæ  */
    .sidebar {
      width: 280px;
      background: #FFFFFF;
      border-right: 1px solid #E2E8F0;
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
    }

    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid #E2E8F0;
    }

    .sidebar-logo {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }

    .logo-icon {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      background: linear-gradient(135deg, #2563EB 0%, #7C3AED 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 20px;
    }

    .logo-text {
      font-size: 18px;
      font-weight: 700;
      color: #1E293B;
    }

    .sidebar-desc {
      font-size: 12px;
      color: #64748B;
      line-height: 1.5;
    }

    .sidebar-nav {
      flex: 1;
      padding: 16px 12px;
      overflow-y: auto;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-bottom: 8px;
      border: none;
      background: transparent;
      width: 100%;
      text-align: left;
    }

    .nav-item:hover {
      background: #F1F5F9;
    }

    .nav-item.active {
      background: #EFF6FF;
      color: #2563EB;
    }

    .nav-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    .nav-item.active .nav-icon {
      background: rgba(37, 99, 235, 0.1);
    }

    .nav-item:not(.active) .nav-icon {
      background: #F1F5F9;
    }

    .nav-text {
      flex: 1;
    }

    .nav-title {
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 2px;
    }

    .nav-desc {
      font-size: 12px;
      color: #64748B;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* å³ä¾§ä¸»åŒºåŸŸ */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* æ¬¢è¿é¡µé¢ */
    .welcome-page {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px;
      text-align: center;
      overflow-y: auto;
    }

    .welcome-page.hidden {
      display: none;
    }

    .welcome-icon {
      width: 96px;
      height: 96px;
      border-radius: 24px;
      background: linear-gradient(135deg, #2563EB 0%, #7C3AED 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 24px;
      box-shadow: 0 20px 40px -10px rgba(37, 99, 235, 0.3);
      font-size: 48px;
    }

    .welcome-title {
      font-size: 36px;
      font-weight: 700;
      margin-bottom: 16px;
      color: #1E293B;
    }

    .welcome-desc {
      font-size: 16px;
      color: #64748B;
      max-width: 500px;
      line-height: 1.6;
      margin-bottom: 32px;
    }

    /* Chat å®¹å™¨ */
    .chat-container {
      flex: 1;
      display: none;
      flex-direction: column;
      overflow: hidden;
      background: white;
    }

    .chat-container.active {
      display: flex;
    }

    .chat-header {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 24px;
      background: white;
      border-bottom: 1px solid #E2E8F0;
      flex-shrink: 0;
    }

    .back-btn {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      border: none;
      background: #F1F5F9;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    .back-btn:hover {
      background: #E2E8F0;
    }

    .back-btn svg {
      width: 20px;
      height: 20px;
      color: #64748B;
    }

    .chat-header-info {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
    }

    .chat-header-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }

    .chat-header-title {
      font-size: 16px;
      font-weight: 600;
      color: #1E293B;
    }

    .chat-header-desc {
      font-size: 12px;
      color: #64748B;
    }

    .iframe-container {
      flex: 1;
      overflow: hidden;
    }

    .iframe-container iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    /* åŠ è½½åŠ¨ç”» */
    .loading {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: white;
      z-index: 10;
    }

    .loading.hidden {
      display: none;
    }

    .loading-spinner {
      width: 48px;
      height: 48px;
      border: 4px solid #E2E8F0;
      border-top-color: #2563EB;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 16px;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .loading-text {
      color: #64748B;
      font-size: 14px;
    }

    .feature-desc {
      font-size: 12px;
      color: #64748B;
    }

    /* å¹²è´§åŒºåŸŸæ ·å¼ */
    .tips-section {
      width: 100%;
      max-width: 900px;
      margin-bottom: 32px;
    }

    .tips-title {
      font-size: 18px;
      font-weight: 600;
      color: #1E293B;
      margin-bottom: 16px;
      text-align: left;
    }

    .tips-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      width: 100%;
    }

    .tip-card {
      background: white;
      border-radius: 16px;
      padding: 20px;
      border: 1px solid #E2E8F0;
      text-align: left;
      transition: all 0.3s ease;
    }

    .tip-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 24px -8px rgba(0, 0, 0, 0.1);
      border-color: #2563EB;
    }

    .tip-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
    }

    .tip-tag {
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 500;
    }

    .tip-tag.hot {
      background: #FEE2E2;
      color: #DC2626;
    }

    .tip-tag.new {
      background: #DBEAFE;
      color: #2563EB;
    }

    .tip-tag:not(.hot):not(.new) {
      background: #D1FAE5;
      color: #059669;
    }

    .tip-category {
      font-size: 12px;
      color: #64748B;
    }

    .tip-title {
      font-size: 15px;
      font-weight: 600;
      color: #1E293B;
      margin-bottom: 8px;
    }

    .tip-content {
      font-size: 13px;
      color: #64748B;
      line-height: 1.6;
      margin-bottom: 12px;
    }

    .tip-footer {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: #94A3B8;
    }

    /* é¢è¯•é—®é¢˜åŒºåŸŸæ ·å¼ */
    .questions-section {
      width: 100%;
      max-width: 900px;
      background: white;
      border-radius: 16px;
      padding: 24px;
      border: 1px solid #E2E8F0;
    }

    .questions-title {
      font-size: 18px;
      font-weight: 600;
      color: #1E293B;
      margin-bottom: 16px;
      text-align: left;
    }

    .questions-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .question-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 12px 16px;
      background: #F8FAFC;
      border-radius: 10px;
      transition: all 0.2s ease;
    }

    .question-item:hover {
      background: #EFF6FF;
    }

    .question-rank {
      font-size: 14px;
      font-weight: 700;
      color: #2563EB;
      min-width: 28px;
    }

    .question-text {
      flex: 1;
      font-size: 14px;
      color: #1E293B;
      font-weight: 500;
    }

    .question-freq {
      font-size: 12px;
      color: #64748B;
      background: #F1F5F9;
      padding: 4px 10px;
      border-radius: 6px;
    }

    .questions-hint {
      margin-top: 16px;
      font-size: 13px;
      color: #64748B;
      text-align: center;
    }

    /* åŠ è½½éª¨æ¶å± */
    .loading-skeleton {
      display: flex;
      align-items: center;
      justify-content: center;
      background: #F1F5F9;
      border: 1px dashed #E2E8F0;
    }

    .loading-skeleton .loading-spinner {
      width: 24px;
      height: 24px;
      border-width: 2px;
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- å·¦ä¾§å¯¼èˆªæ  -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="logo-icon">âœ¨</div>
          <span class="logo-text">æ±‚èŒå¯¼å¸ˆ</span>
        </div>
        <p class="sidebar-desc">ç‚¹å‡»ä¸‹æ–¹é€‰é¡¹å¡è¿›å…¥æ™ºèƒ½ä½“è¿›è¡Œæ¨¡æ‹Ÿç»ƒä¹ </p>
      </div>
      
      <nav class="sidebar-nav">
        <button class="nav-item" data-index="0" onclick="switchBot(this, 0)">
          <div class="nav-icon">ğŸ¯</div>
          <div class="nav-text">
            <div class="nav-title">æ¨¡æ‹Ÿé¢è¯•å®˜</div>
            <div class="nav-desc">æ¨¡æ‹ŸçœŸå®é¢è¯•åœºæ™¯</div>
          </div>
        </button>
        
        <button class="nav-item" data-index="1" onclick="switchBot(this, 1)">
          <div class="nav-icon">ğŸ“Š</div>
          <div class="nav-text">
            <div class="nav-title">å¤ç›˜å¯¼å¸ˆ</div>
            <div class="nav-desc">æ·±åº¦åˆ†æé¢è¯•è¡¨ç°</div>
          </div>
        </button>
        
        <button class="nav-item" data-index="2" onclick="switchBot(this, 2)">
          <div class="nav-icon">ğŸ’¡</div>
          <div class="nav-text">
            <div class="nav-title">è¡Œä¸šæ¡ˆä¾‹æ‹†è§£</div>
            <div class="nav-desc">æ‹†è§£è¡Œä¸šçœŸå®æ¡ˆä¾‹</div>
          </div>
        </button>
      </nav>
    </aside>

    <!-- å³ä¾§ä¸»åŒºåŸŸ -->
    <main class="main-content">
      <!-- æ¬¢è¿é¡µé¢ -->
      <div class="welcome-page" id="welcomePage">
        <div class="welcome-icon">âœ¨</div>
        <h1 class="welcome-title">æ¬¢è¿ä½¿ç”¨æ±‚èŒå¯¼å¸ˆ</h1>
        <p class="welcome-desc">AI é¢è¯•åŠ©æ‰‹å¹³å°ï¼Œç²¾é€‰é¢è¯•å¹²è´§ä¸æ±‚èŒæŠ€å·§ï¼ŒåŠ©ä½ ä»å®¹åº”å¯¹æ¯ä¸€æ¬¡é¢è¯•æŒ‘æˆ˜</p>
        
        <!-- ä»Šæ—¥å¹²è´§åŒºåŸŸ -->
        <div class="tips-section">
          <h3 class="tips-title">ğŸ“š ä»Šæ—¥é¢è¯•å¹²è´§ <span id="todayDate" style="font-size: 12px; color: #64748B; font-weight: 400;"></span></h3>
          <div class="tips-grid" id="tipsGrid">
            <!-- åŠ¨æ€åŠ è½½ -->
            <div class="tip-card loading-skeleton" style="height: 160px;">
              <div class="loading-spinner"></div>
            </div>
            <div class="tip-card loading-skeleton" style="height: 160px;">
              <div class="loading-spinner"></div>
            </div>
            <div class="tip-card loading-skeleton" style="height: 160px;">
              <div class="loading-spinner"></div>
            </div>
          </div>
        </div>

        <!-- é«˜é¢‘é¢è¯•é¢˜åŒºåŸŸ -->
        <div class="questions-section">
          <h3 class="questions-title">ğŸ¯ é«˜é¢‘é¢è¯•é—®é¢˜ TOP 5</h3>
          <div class="questions-list" id="questionsList">
            <!-- åŠ¨æ€åŠ è½½ -->
            <div class="question-item loading-skeleton" style="height: 48px;">
              <div class="loading-spinner"></div>
            </div>
          </div>
          <p class="questions-hint">ğŸ’¡ ç‚¹å‡»å·¦ä¾§"æ¨¡æ‹Ÿé¢è¯•å®˜"å¼€å§‹å®æˆ˜ç»ƒä¹ </p>
        </div>
      </div>

      <!-- Chat å®¹å™¨ -->
      <div class="chat-container" id="chatContainer">
        <div class="chat-header">
          <button class="back-btn" onclick="goBack()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
          </button>
          <div class="chat-header-info">
            <div class="chat-header-icon" id="chatHeaderIcon">ğŸ¯</div>
            <div>
              <div class="chat-header-title" id="chatHeaderTitle">æ¨¡æ‹Ÿé¢è¯•å®˜</div>
              <div class="chat-header-desc" id="chatHeaderDesc">æ¨¡æ‹ŸçœŸå®é¢è¯•åœºæ™¯ï¼Œæä¾›å³æ—¶åé¦ˆ</div>
            </div>
          </div>
        </div>
        <div class="iframe-container" style="position: relative;">
          <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <div class="loading-text">æ­£åœ¨åŠ è½½æ™ºèƒ½ä½“...</div>
          </div>
          <iframe id="botIframe" src="" width="100%" height="100%" frameborder="0" onload="onIframeLoad()"></iframe>
        </div>
      </div>
    </main>
  </div>

  <script>
    // Supabase é…ç½®
    const SUPABASE_URL = 'https://br-handy-lynx-9086283c.supabase2.aidap-global.cn-beijing.volces.com';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjMzNTE1MTA3NTMsInJvbGUiOiJhbm9uIn0.ODDduCUBJt9ksTFoG7cWVZ7Pn6vLoRgeZwH3nlVjJgk';
    
    // ç›´æ¥ä½¿ç”¨ fetch è°ƒç”¨ Supabase REST API
    async function supabaseFetch(table, options = {}) {
      const params = new URLSearchParams();
      if (options.select) params.append('select', options.select);
      if (options.filter) {
        Object.entries(options.filter).forEach(([key, value]) => {
          params.append(key, `eq.${value}`);
        });
      }
      if (options.order) params.append('order', `${options.order.column}.${options.order.ascending ? 'asc' : 'desc'}`);
      if (options.limit) params.append('limit', options.limit);
      
      const url = `${SUPABASE_URL}/rest/v1/${table}?${params.toString()}`;
      
      const response = await fetch(url, {
        headers: {
          'apikey': SUPABASE_ANON_KEY,
          'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
          'Content-Type': 'application/json'
        }
      });
      
      if (!response.ok) {
        throw new Error(`Supabase error: ${response.status}`);
      }
      
      return response.json();
    }

    // æ™ºèƒ½ä½“é…ç½®
    const bots = [
      {
        id: '7606673064772091930',
        title: 'æ¨¡æ‹Ÿé¢è¯•å®˜',
        description: 'æ¨¡æ‹ŸçœŸå®é¢è¯•åœºæ™¯ï¼Œæä¾›å³æ—¶åé¦ˆï¼Œå¸®åŠ©ç»ƒä¹ é¢è¯•æŠ€å·§',
        icon: 'ğŸ¯',
        color: '#2563EB',
        url: 'https://www.coze.cn/store/agent/7606673064772091930?bot_id=true'
      },
      {
        id: '7607141289817735211',
        title: 'å¤ç›˜å¯¼å¸ˆ',
        description: 'æ·±åº¦åˆ†æé¢è¯•è¡¨ç°ï¼Œè¯†åˆ«é—®é¢˜å¹¶æä¾›ä¸ªæ€§åŒ–æ”¹è¿›å»ºè®®',
        icon: 'ğŸ“Š',
        color: '#059669',
        url: 'https://www.coze.cn/store/agent/7607141289817735211?bot_id=true'
      },
      {
        id: '7607480544884293647',
        title: 'è¡Œä¸šæ¡ˆä¾‹æ‹†è§£',
        description: 'æ‹†è§£è¡Œä¸šçœŸå®æ¡ˆä¾‹ï¼Œå¸®åŠ©ç†è§£ä¸šåŠ¡é€»è¾‘å’Œè¡Œä¸šè¶‹åŠ¿',
        icon: 'ğŸ’¡',
        color: '#7C3AED',
        url: 'https://www.coze.cn/store/agent/7607480544884293647?bot_id=true&bid=6j4qate1c0g18'
      }
    ];

    let currentBotIndex = -1;

    // åˆ‡æ¢æ™ºèƒ½ä½“
    function switchBot(element, index) {
      loadBot(index);
    }

    // é€šè¿‡ç´¢å¼•åˆ‡æ¢æ™ºèƒ½ä½“
    function switchBotByIndex(index) {
      loadBot(index);
    }

    // åŠ è½½æ™ºèƒ½ä½“
    function loadBot(index) {
      if (currentBotIndex === index) return;
      
      const bot = bots[index];
      currentBotIndex = index;

      // æ›´æ–°å¯¼èˆªæ é€‰ä¸­çŠ¶æ€
      document.querySelectorAll('.nav-item').forEach((item, i) => {
        item.classList.toggle('active', i === index);
      });

      // æ›´æ–°èŠå¤©å¤´éƒ¨ä¿¡æ¯
      document.getElementById('chatHeaderIcon').textContent = bot.icon;
      document.getElementById('chatHeaderIcon').style.background = bot.color + '15';
      document.getElementById('chatHeaderTitle').textContent = bot.title;
      document.getElementById('chatHeaderDesc').textContent = bot.description;

      // æ˜¾ç¤ºèŠå¤©å®¹å™¨
      document.getElementById('welcomePage').classList.add('hidden');
      document.getElementById('chatContainer').classList.add('active');
      
      // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
      document.getElementById('loading').classList.remove('hidden');

      // è®¾ç½® iframe src
      document.getElementById('botIframe').src = bot.url;
    }

    // iframe åŠ è½½å®Œæˆ
    function onIframeLoad() {
      document.getElementById('loading').classList.add('hidden');
    }

    // è¿”å›æ¬¢è¿é¡µ
    function goBack() {
      currentBotIndex = -1;
      
      // æ¸…é™¤å¯¼èˆªæ é€‰ä¸­çŠ¶æ€
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });

      // æ˜¾ç¤ºæ¬¢è¿é¡µ
      document.getElementById('welcomePage').classList.remove('hidden');
      document.getElementById('chatContainer').classList.remove('active');

      // æ¸…ç©º iframe
      document.getElementById('botIframe').src = '';
    }

    // åŠ è½½é¦–é¡µæ•°æ® - è°ƒç”¨åç«¯ API
    async function loadHomeData() {
      try {
        // è°ƒç”¨åç«¯ API è·å–é¦–é¡µæ•°æ®ï¼ˆå·²å¤„ç†æ—¥æœŸè½®æ¢é€»è¾‘ï¼‰
        const response = await fetch('/api/home');
        const data = await response.json();
        
        // æ›´æ–°æ—¥æœŸæ˜¾ç¤º
        document.getElementById('todayDate').textContent = `(${data.today_date})`;
        
        // æ¸²æŸ“å¹²è´§å†…å®¹ï¼ˆåç«¯å·²è¿”å›ä»Šæ—¥3æ¡å¹²è´§ï¼‰
        renderTips(data.tips);
        
        // æ¸²æŸ“é«˜é¢‘é—®é¢˜
        renderQuestions(data.questions);
        
      } catch (error) {
        console.error('åŠ è½½é¦–é¡µæ•°æ®å¤±è´¥:', error);
        document.getElementById('tipsGrid').innerHTML = '<p style="color: #64748B; text-align: center; grid-column: 1/-1;">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•</p>';
        document.getElementById('questionsList').innerHTML = '<p style="color: #64748B; text-align: center;">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•</p>';
      }
    }

    // æ¸²æŸ“å¹²è´§å†…å®¹
    function renderTips(tips) {
      const container = document.getElementById('tipsGrid');
      
      if (!tips || tips.length === 0) {
        container.innerHTML = '<p style="color: #64748B; text-align: center; grid-column: 1/-1;">æš‚æ— å†…å®¹</p>';
        return;
      }
      
      container.innerHTML = tips.map(tip => {
        // æ ¹æ®æ ‡ç­¾é€‰æ‹©æ ·å¼
        let tagClass = '';
        if (tip.tag === 'çƒ­é—¨') tagClass = 'hot';
        else if (tip.tag === 'æ–°') tagClass = 'new';
        
        // æ ¼å¼åŒ–é˜…è¯»é‡
        const viewsStr = tip.views >= 1000 ? (tip.views / 1000).toFixed(1) + 'k' : tip.views;
        
        // æ„å»º AI è§£è¯»é“¾æ¥
        const aiChatUrl = `ai-chat.html?tag=${encodeURIComponent(tip.tag)}&category=${encodeURIComponent(tip.category)}&title=${encodeURIComponent(tip.title)}&content=${encodeURIComponent(tip.content)}`;
        
        return `
          <div class="tip-card" onclick="openAIChat('${aiChatUrl.replace(/'/g, "\\'")}')">
            <div class="tip-header">
              <span class="tip-tag ${tagClass}">${tip.tag}</span>
              <span class="tip-category">${tip.category}</span>
            </div>
            <h4 class="tip-title">${tip.title}</h4>
            <p class="tip-content">${tip.content}</p>
            <div class="tip-footer">
              <span class="tip-views">ğŸ‘ ${viewsStr} é˜…è¯»</span>
              <span class="tip-time">${tip.read_time}é˜…è¯»</span>
            </div>
          </div>
        `;
      }).join('');
    }
    
    // æ‰“å¼€ AI è§£è¯»é¡µé¢
    function openAIChat(url) {
      window.location.href = url;
    }

    // æ¸²æŸ“é«˜é¢‘é—®é¢˜
    function renderQuestions(questions) {
      const container = document.getElementById('questionsList');
      
      if (!questions || questions.length === 0) {
        container.innerHTML = '<p style="color: #64748B; text-align: center;">æš‚æ— å†…å®¹</p>';
        return;
      }
      
      container.innerHTML = questions.map(q => {
        const rankStr = q.rank.toString().padStart(2, '0');
        return `
          <div class="question-item">
            <span class="question-rank">${rankStr}</span>
            <span class="question-text">${q.question}</span>
            <span class="question-freq">å‡ºç°é¢‘ç‡ ${q.frequency}</span>
          </div>
        `;
      }).join('');
    }

    // å¢åŠ é˜…è¯»é‡ - ä½¿ç”¨ fetch è°ƒç”¨ Supabase
    async function incrementView(id, type) {
      try {
        if (type === 'tip') {
          // å…ˆè·å–å½“å‰é˜…è¯»é‡
          const data = await supabaseFetch('interview_tips', {
            select: 'views',
            filter: { id: id }
          });
          
          if (data && data.length > 0) {
            const newViews = (data[0].views || 0) + 1;
            // ä½¿ç”¨ PATCH æ›´æ–°
            await fetch(`${SUPABASE_URL}/rest/v1/interview_tips?id=eq.${id}`, {
              method: 'PATCH',
              headers: {
                'apikey': SUPABASE_ANON_KEY,
                'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                'Content-Type': 'application/json',
                'Prefer': 'return=minimal'
              },
              body: JSON.stringify({ views: newViews })
            });
          }
        }
      } catch (error) {
        console.error('æ›´æ–°é˜…è¯»é‡å¤±è´¥:', error);
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆåè·å–æ•°æ®
    document.addEventListener('DOMContentLoaded', loadHomeData);
  </script>
</body>
</html>
